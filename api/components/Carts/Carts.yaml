swagger: "2.0"
info:
  title: Order API
  version: 1.0.0
  description: >
    API specification for shopping cart, checkout, and order management (customer-facing).

host: api.adornme.com
basePath: /v1
schemes:
  - https

tags:
  - name: Cart
    description: Manage shopping cart
  - name: Orders
    description: Checkout and order management

paths:
  /cart:
    get:
      summary: Get current user's cart
      tags:
        - Cart
      security:
        - bearerAuth: []
      responses:
        200:
          description: Current shopping cart
          schema:
            $ref: "#/definitions/Cart"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrorResponse"

    post:
      summary: Add item to cart
      tags:
        - Cart
      security:
        - bearerAuth: []
      parameters:
        - in: body
          name: body
          required: true
          schema:
            $ref: "#/definitions/CartItemRequest"
      responses:
        200:
          description: Item added to cart
          schema:
            $ref: "#/definitions/Cart"

    put:
      summary: Update item quantity in cart
      tags:
        - Cart
      security:
        - bearerAuth: []
      parameters:
        - in: body
          name: body
          required: true
          schema:
            $ref: "#/definitions/CartItemUpdateRequest"
      responses:
        200:
          description: Cart updated
          schema:
            $ref: "#/definitions/Cart"

    delete:
      summary: Clear cart
      tags:
        - Cart
      security:
        - bearerAuth: []
      responses:
        204:
          description: Cart cleared

  /orders:
    post:
      summary: Place an order from cart
      tags:
        - Orders
      security:
        - bearerAuth: []
      parameters:
        - in: body
          name: body
          required: true
          schema:
            $ref: "#/definitions/OrderCreateRequest"
      responses:
        201:
          description: Order placed successfully
          schema:
            $ref: "#/definitions/Order"
        400:
          description: Invalid order request
          schema:
            $ref: "#/definitions/ErrorResponse"

    get:
      summary: List user's orders
      tags:
        - Orders
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          type: integer
          default: 1
        - name: limit
          in: query
          type: integer
          default: 10
      responses:
        200:
          description: Paginated list of orders
          schema:
            $ref: "#/definitions/OrderListResponse"

  /orders/{id}:
    get:
      summary: Get order details
      tags:
        - Orders
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          type: integer
      responses:
        200:
          description: Order details
          schema:
            $ref: "#/definitions/Order"
        404:
          description: Order not found
          schema:
            $ref: "#/definitions/ErrorResponse"

securityDefinitions:
  bearerAuth:
    type: apiKey
    name: Authorization
    in: header

definitions:
  Cart:
    type: object
    properties:
      items:
        type: array
        items:
          $ref: "#/definitions/CartItem"
      totalPrice:
        type: number
        format: float
        example: 2999.50

  CartItem:
    type: object
    properties:
      productId:
        type: integer
        example: 101
      name:
        type: string
        example: Gold Ring
      quantity:
        type: integer
        example: 2
      price:
        type: number
        format: float
        example: 1499.75
      subtotal:
        type: number
        format: float
        example: 2999.50

  CartItemRequest:
    type: object
    required: [productId, quantity]
    properties:
      productId:
        type: integer
      quantity:
        type: integer
        minimum: 1

  CartItemUpdateRequest:
    type: object
    required: [productId, quantity]
    properties:
      productId:
        type: integer
      quantity:
        type: integer
        minimum: 1

  Order:
    type: object
    properties:
      id:
        type: integer
        example: 5001
      userId:
        type: integer
        example: 101
      items:
        type: array
        items:
          $ref: "#/definitions/CartItem"
      totalPrice:
        type: number
        format: float
        example: 2999.50
      status:
        type: string
        enum: [pending, paid, shipped, delivered, cancelled]
        example: pending
      createdAt:
        type: string
        format: date-time
      updatedAt:
        type: string
        format: date-time

  OrderCreateRequest:
    type: object
    required: [shippingAddressId, paymentMethod]
    properties:
      shippingAddressId:
        type: integer
        example: 2001
      paymentMethod:
        type: string
        enum: [cod, card, netbanking, upi]
        example: upi

  OrderListResponse:
    type: object
    properties:
      page:
        type: integer
      limit:
        type: integer
      total:
        type: integer
      items:
        type: array
        items:
          $ref: "#/definitions/Order"

  ErrorResponse:
    type: object
    required: [error, message]
    properties:
      error:
        type: string
        example: BadRequest
      message:
        type: string
        example: Invalid order data
